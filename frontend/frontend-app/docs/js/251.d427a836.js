"use strict";(self["webpackChunkfrontend_app"]=self["webpackChunkfrontend_app"]||[]).push([[251],{1570:function(e,a,l){l.d(a,{x:function(){return r}});l(8111),l(116);var t=l(2261);const r=(0,t.nY)("curtain",{state:()=>({curtains:[],categories:[],currentCurtain:null,loading:!1,error:null}),actions:{async fetchCurtains(){this.loading=!0;try{const e=await fetch("/data/curtains.json"),a=await e.json();this.curtains=a.curtains,this.error=null}catch(e){this.error="获取窗帘样本失败: "+e.message,console.error("获取窗帘样本失败:",e)}finally{this.loading=!1}},async fetchCurtainById(e){this.loading=!0;try{const a=await fetch("/data/curtains.json"),l=await a.json();this.currentCurtain=l.curtains.find((a=>a.id===e)),this.error=null}catch(a){this.error="获取窗帘样本详情失败: "+a.message,console.error("获取窗帘样本详情失败:",a)}finally{this.loading=!1}},async fetchCategories(){this.loading=!0;try{const e=await fetch("/data/curtains.json"),a=await e.json();this.categories=a.categories,this.error=null}catch(e){this.error="获取分类失败: "+e.message,console.error("获取分类失败:",e)}finally{this.loading=!1}}}})},3251:function(e,a,l){l.r(a),l.d(a,{default:function(){return _}});var t=l(6768),r=l(4232);const i={class:"curtain-manage-container"},o={class:"page-header"},n={key:0,class:"loading-container"},u={key:1,class:"error-message"},d={key:2},s={class:"image-error"},c={key:1},m=["src"];function p(e,a,l,p,b,g){const f=(0,t.g2)("el-button"),F=(0,t.g2)("el-input"),k=(0,t.g2)("el-form-item"),h=(0,t.g2)("el-option"),_=(0,t.g2)("el-select"),y=(0,t.g2)("el-form"),w=(0,t.g2)("el-card"),v=(0,t.g2)("el-skeleton"),V=(0,t.g2)("el-alert"),C=(0,t.g2)("el-table-column"),U=(0,t.g2)("picture-failed"),W=(0,t.g2)("el-icon"),R=(0,t.g2)("el-image"),X=(0,t.g2)("el-tag"),E=(0,t.g2)("el-popconfirm"),K=(0,t.g2)("el-table"),L=(0,t.g2)("plus"),j=(0,t.g2)("el-upload"),x=(0,t.g2)("el-input-number"),D=(0,t.g2)("el-switch"),I=(0,t.g2)("el-dialog"),S=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",i,[(0,t.Lk)("div",o,[a[17]||(a[17]=(0,t.Lk)("h2",null,"窗帘样本管理",-1)),(0,t.bF)(f,{type:"primary",onClick:p.showAddDialog},{default:(0,t.k6)((()=>a[16]||(a[16]=[(0,t.eW)("添加新样本")]))),_:1},8,["onClick"])]),(0,t.bF)(w,{class:"filter-card"},{default:(0,t.k6)((()=>[(0,t.bF)(y,{inline:!0,model:p.filterForm,class:"filter-form"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{label:"样本名称"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:p.filterForm.name,"onUpdate:modelValue":a[0]||(a[0]=e=>p.filterForm.name=e),placeholder:"输入名称关键词",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(k,{label:"分类"},{default:(0,t.k6)((()=>[(0,t.bF)(_,{modelValue:p.filterForm.category_id,"onUpdate:modelValue":a[1]||(a[1]=e=>p.filterForm.category_id=e),placeholder:"选择分类",clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(p.curtainStore.categories,(e=>((0,t.uX)(),(0,t.Wv)(h,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(k,{label:"库存状态"},{default:(0,t.k6)((()=>[(0,t.bF)(_,{modelValue:p.filterForm.in_stock,"onUpdate:modelValue":a[2]||(a[2]=e=>p.filterForm.in_stock=e),placeholder:"库存状态",clearable:""},{default:(0,t.k6)((()=>[(0,t.bF)(h,{label:"有库存",value:!0}),(0,t.bF)(h,{label:"缺货",value:!1})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(k,null,{default:(0,t.k6)((()=>[(0,t.bF)(f,{type:"primary",onClick:p.handleFilter},{default:(0,t.k6)((()=>a[18]||(a[18]=[(0,t.eW)("搜索")]))),_:1},8,["onClick"]),(0,t.bF)(f,{onClick:p.resetFilter},{default:(0,t.k6)((()=>a[19]||(a[19]=[(0,t.eW)("重置")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1}),(0,t.bF)(w,{class:"table-card"},{default:(0,t.k6)((()=>[p.curtainStore.loading?((0,t.uX)(),(0,t.CE)("div",n,[(0,t.bF)(v,{rows:10,animated:""})])):p.curtainStore.error?((0,t.uX)(),(0,t.CE)("div",u,[(0,t.bF)(V,{title:p.curtainStore.error,type:"error","show-icon":""},null,8,["title"])])):((0,t.uX)(),(0,t.CE)("div",d,[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(K,{data:p.curtainStore.curtains,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(C,{prop:"id",label:"ID",width:"80"}),(0,t.bF)(C,{label:"图片",width:"120"},{default:(0,t.k6)((({row:e})=>[(0,t.bF)(R,{src:e.image_url,style:{width:"80px",height:"80px"},fit:"cover","preview-src-list":[e.image_url]},{error:(0,t.k6)((()=>[(0,t.Lk)("div",s,[(0,t.bF)(W,null,{default:(0,t.k6)((()=>[(0,t.bF)(U)])),_:1})])])),_:2},1032,["src","preview-src-list"])])),_:1}),(0,t.bF)(C,{prop:"name",label:"名称"}),(0,t.bF)(C,{prop:"category_name",label:"分类",width:"120"}),(0,t.bF)(C,{label:"库存状态",width:"100"},{default:(0,t.k6)((({row:e})=>[(0,t.bF)(X,{type:e.in_stock?"success":"danger"},{default:(0,t.k6)((()=>[(0,t.eW)((0,r.v_)(e.in_stock?"有库存":"缺货"),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(C,{label:"新品",width:"80"},{default:(0,t.k6)((({row:e})=>[e.is_new?((0,t.uX)(),(0,t.Wv)(X,{key:0,type:"warning"},{default:(0,t.k6)((()=>a[20]||(a[20]=[(0,t.eW)("新品")]))),_:1})):((0,t.uX)(),(0,t.CE)("span",c,"-"))])),_:1}),(0,t.bF)(C,{label:"操作",width:"200"},{default:(0,t.k6)((({row:e})=>[(0,t.bF)(f,{size:"small",onClick:a=>p.showEditDialog(e)},{default:(0,t.k6)((()=>a[21]||(a[21]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(E,{title:"确定要删除这个窗帘样本吗？",onConfirm:a=>p.handleDelete(e.id)},{reference:(0,t.k6)((()=>[(0,t.bF)(f,{size:"small",type:"danger"},{default:(0,t.k6)((()=>a[22]||(a[22]=[(0,t.eW)("删除")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[S,p.tableLoading]])]))])),_:1}),(0,t.bF)(I,{title:"add"===p.dialogType?"添加窗帘样本":"编辑窗帘样本",modelValue:p.dialogVisible,"onUpdate:modelValue":a[15]||(a[15]=e=>p.dialogVisible=e),width:"600px"},{footer:(0,t.k6)((()=>[(0,t.bF)(f,{onClick:a[14]||(a[14]=e=>p.dialogVisible=!1)},{default:(0,t.k6)((()=>a[24]||(a[24]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(f,{type:"primary",onClick:p.handleSubmit,loading:p.submitLoading},{default:(0,t.k6)((()=>a[25]||(a[25]=[(0,t.eW)("确定")]))),_:1},8,["onClick","loading"])])),default:(0,t.k6)((()=>[(0,t.bF)(y,{ref:"curtainFormRef",model:p.curtainForm,rules:p.curtainRules,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{label:"样本名称",prop:"name"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:p.curtainForm.name,"onUpdate:modelValue":a[3]||(a[3]=e=>p.curtainForm.name=e),placeholder:"请输入窗帘样本名称"},null,8,["modelValue"])])),_:1}),(0,t.bF)(k,{label:"分类",prop:"category_id"},{default:(0,t.k6)((()=>[(0,t.bF)(_,{modelValue:p.curtainForm.category_id,"onUpdate:modelValue":a[4]||(a[4]=e=>p.curtainForm.category_id=e),placeholder:"请选择分类"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(p.curtainStore.categories,(e=>((0,t.uX)(),(0,t.Wv)(h,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(k,{label:"样本图片",prop:"image"},{default:(0,t.k6)((()=>[(0,t.bF)(j,{class:"image-upload",action:"#","http-request":p.handleImageUpload,"show-file-list":!1,"before-upload":p.beforeImageUpload},{default:(0,t.k6)((()=>[p.imageUrl?((0,t.uX)(),(0,t.CE)("img",{key:0,src:p.imageUrl,class:"preview-image"},null,8,m)):((0,t.uX)(),(0,t.Wv)(W,{key:1,class:"upload-icon"},{default:(0,t.k6)((()=>[(0,t.bF)(L)])),_:1})),a[23]||(a[23]=(0,t.Lk)("div",{class:"upload-text"},"点击上传图片",-1))])),_:1},8,["http-request","before-upload"])])),_:1}),(0,t.bF)(k,{label:"价格",prop:"price"},{default:(0,t.k6)((()=>[(0,t.bF)(x,{modelValue:p.curtainForm.price,"onUpdate:modelValue":a[5]||(a[5]=e=>p.curtainForm.price=e),precision:2,step:10,min:0},null,8,["modelValue"])])),_:1}),(0,t.bF)(k,{label:"材质",prop:"material"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:p.curtainForm.material,"onUpdate:modelValue":a[6]||(a[6]=e=>p.curtainForm.material=e),placeholder:"请输入窗帘材质"},null,8,["modelValue"])])),_:1}),(0,t.bF)(k,{label:"宽度",prop:"width"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:p.curtainForm.width,"onUpdate:modelValue":a[7]||(a[7]=e=>p.curtainForm.width=e),placeholder:"请输入窗帘宽度"},null,8,["modelValue"])])),_:1}),(0,t.bF)(k,{label:"图案",prop:"pattern"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:p.curtainForm.pattern,"onUpdate:modelValue":a[8]||(a[8]=e=>p.curtainForm.pattern=e),placeholder:"请输入窗帘图案"},null,8,["modelValue"])])),_:1}),(0,t.bF)(k,{label:"风格",prop:"style"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:p.curtainForm.style,"onUpdate:modelValue":a[9]||(a[9]=e=>p.curtainForm.style=e),placeholder:"请输入窗帘风格"},null,8,["modelValue"])])),_:1}),(0,t.bF)(k,{label:"功能",prop:"features"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:p.curtainForm.features,"onUpdate:modelValue":a[10]||(a[10]=e=>p.curtainForm.features=e),placeholder:"请输入窗帘功能特点"},null,8,["modelValue"])])),_:1}),(0,t.bF)(k,{label:"描述",prop:"description"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:p.curtainForm.description,"onUpdate:modelValue":a[11]||(a[11]=e=>p.curtainForm.description=e),type:"textarea",rows:4,placeholder:"请输入窗帘样本描述"},null,8,["modelValue"])])),_:1}),(0,t.bF)(k,{label:"库存状态",prop:"in_stock"},{default:(0,t.k6)((()=>[(0,t.bF)(D,{modelValue:p.curtainForm.in_stock,"onUpdate:modelValue":a[12]||(a[12]=e=>p.curtainForm.in_stock=e)},null,8,["modelValue"])])),_:1}),(0,t.bF)(k,{label:"新品",prop:"is_new"},{default:(0,t.k6)((()=>[(0,t.bF)(D,{modelValue:p.curtainForm.is_new,"onUpdate:modelValue":a[13]||(a[13]=e=>p.curtainForm.is_new=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])}l(8111),l(2489),l(7588);var b=l(144),g=l(1570),f=l(1219),F={name:"CurtainManage",setup(){const e=(0,g.x)(),a=(0,b.KR)(null),l=(0,b.KR)(!1),r=(0,b.KR)("add"),i=(0,b.KR)(!1),o=(0,b.KR)(!1),n=(0,b.KR)(""),u=(0,b.KR)(null),d=(0,b.Kh)({name:"",category_id:"",in_stock:""}),s=(0,b.Kh)({id:null,name:"",category_id:"",price:0,material:"",width:"",pattern:"",style:"",features:"",description:"",in_stock:!0,is_new:!1}),c={name:[{required:!0,message:"请输入窗帘样本名称",trigger:"blur"},{min:2,max:50,message:"长度应为2-50个字符",trigger:"blur"}],category_id:[{required:!0,message:"请选择分类",trigger:"change"}],description:[{required:!0,message:"请输入窗帘样本描述",trigger:"blur"}]};(0,t.sV)((async()=>{e.categories.length||await e.fetchCategories(),await e.fetchCurtains()}));const m=()=>{r.value="add",F(),l.value=!0},p=e=>{r.value="edit",F(),Object.keys(s).forEach((a=>{a in e&&(s[a]=e[a])})),e.image_url&&(n.value=e.image_url),l.value=!0},F=()=>{a.value&&a.value.resetFields(),Object.assign(s,{id:null,name:"",category_id:"",price:0,material:"",width:"",pattern:"",style:"",features:"",description:"",in_stock:!0,is_new:!1}),n.value="",u.value=null},k=e=>{const a=e.type.startsWith("image/"),l=e.size/1024/1024<2;return a?!!l||(f.nk.error("图片大小不能超过2MB!"),!1):(f.nk.error("只能上传图片文件!"),!1)},h=e=>{const a=e.file;u.value=a;const l=new FileReader;l.onload=e=>{n.value=e.target.result},l.readAsDataURL(a)},_=async()=>{a.value&&await a.value.validate((async a=>{if(a){i.value=!0;try{const a=new FormData;Object.keys(s).forEach((e=>{"id"!==e&&a.append(e,s[e])})),u.value&&a.append("image",u.value),"add"===r.value?(await e.addCurtain(a),f.nk.success("添加窗帘样本成功")):(await e.updateCurtain(s.id,a),f.nk.success("更新窗帘样本成功")),l.value=!1,F()}catch(t){f.nk.error(t.message||"操作失败")}finally{i.value=!1}}}))},y=async a=>{try{o.value=!0,await e.deleteCurtain(a),f.nk.success("删除窗帘样本成功")}catch(l){f.nk.error(l.message||"删除失败")}finally{o.value=!1}},w=async()=>{o.value=!0;try{await e.fetchCurtains(),d.name&&(e.curtains=e.curtains.filter((e=>e.name.toLowerCase().includes(d.name.toLowerCase())))),d.category_id&&(e.curtains=e.curtains.filter((e=>e.category_id===d.category_id))),""!==d.in_stock&&(e.curtains=e.curtains.filter((e=>e.in_stock===d.in_stock)))}catch(a){f.nk.error("筛选失败: "+a.message)}finally{o.value=!1}},v=()=>{Object.assign(d,{name:"",category_id:"",in_stock:""}),e.fetchCurtains()};return{curtainStore:e,curtainForm:s,curtainRules:c,curtainFormRef:a,dialogVisible:l,dialogType:r,submitLoading:i,tableLoading:o,imageUrl:n,filterForm:d,showAddDialog:m,showEditDialog:p,handleSubmit:_,handleDelete:y,handleFilter:w,resetFilter:v,beforeImageUpload:k,handleImageUpload:h}}},k=l(1241);const h=(0,k.A)(F,[["render",p],["__scopeId","data-v-46067832"]]);var _=h}}]);
//# sourceMappingURL=251.d427a836.js.map