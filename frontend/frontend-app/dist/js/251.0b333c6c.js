"use strict";(self["webpackChunkfrontend_app"]=self["webpackChunkfrontend_app"]||[]).push([[251],{3251:function(e,l,a){a.r(l),a.d(l,{default:function(){return h}});var t=a(6768),r=a(4232);const i={class:"curtain-manage-container"},o={class:"page-header"},u={key:0,class:"loading-container"},n={key:1,class:"error-message"},d={key:2},c={class:"image-error"},s={key:1},m=["src"];function p(e,l,a,p,b,g){const F=(0,t.g2)("el-button"),k=(0,t.g2)("el-input"),f=(0,t.g2)("el-form-item"),_=(0,t.g2)("el-option"),h=(0,t.g2)("el-select"),y=(0,t.g2)("el-form"),v=(0,t.g2)("el-card"),w=(0,t.g2)("el-skeleton"),V=(0,t.g2)("el-alert"),C=(0,t.g2)("el-table-column"),U=(0,t.g2)("picture-failed"),W=(0,t.g2)("el-icon"),R=(0,t.g2)("el-image"),X=(0,t.g2)("el-tag"),E=(0,t.g2)("el-popconfirm"),K=(0,t.g2)("el-table"),L=(0,t.g2)("plus"),D=(0,t.g2)("el-upload"),S=(0,t.g2)("el-input-number"),x=(0,t.g2)("el-switch"),I=(0,t.g2)("el-dialog"),q=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",i,[(0,t.Lk)("div",o,[l[17]||(l[17]=(0,t.Lk)("h2",null,"窗帘样本管理",-1)),(0,t.bF)(F,{type:"primary",onClick:p.showAddDialog},{default:(0,t.k6)((()=>l[16]||(l[16]=[(0,t.eW)("添加新样本")]))),_:1},8,["onClick"])]),(0,t.bF)(v,{class:"filter-card"},{default:(0,t.k6)((()=>[(0,t.bF)(y,{inline:!0,model:p.filterForm,class:"filter-form"},{default:(0,t.k6)((()=>[(0,t.bF)(f,{label:"样本名称"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:p.filterForm.name,"onUpdate:modelValue":l[0]||(l[0]=e=>p.filterForm.name=e),placeholder:"输入名称关键词",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"分类"},{default:(0,t.k6)((()=>[(0,t.bF)(h,{modelValue:p.filterForm.category_id,"onUpdate:modelValue":l[1]||(l[1]=e=>p.filterForm.category_id=e),placeholder:"选择分类",clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(p.curtainStore.categories,(e=>((0,t.uX)(),(0,t.Wv)(_,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"库存状态"},{default:(0,t.k6)((()=>[(0,t.bF)(h,{modelValue:p.filterForm.in_stock,"onUpdate:modelValue":l[2]||(l[2]=e=>p.filterForm.in_stock=e),placeholder:"库存状态",clearable:""},{default:(0,t.k6)((()=>[(0,t.bF)(_,{label:"有库存",value:!0}),(0,t.bF)(_,{label:"缺货",value:!1})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(f,null,{default:(0,t.k6)((()=>[(0,t.bF)(F,{type:"primary",onClick:p.handleFilter},{default:(0,t.k6)((()=>l[18]||(l[18]=[(0,t.eW)("搜索")]))),_:1},8,["onClick"]),(0,t.bF)(F,{onClick:p.resetFilter},{default:(0,t.k6)((()=>l[19]||(l[19]=[(0,t.eW)("重置")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1}),(0,t.bF)(v,{class:"table-card"},{default:(0,t.k6)((()=>[p.curtainStore.loading?((0,t.uX)(),(0,t.CE)("div",u,[(0,t.bF)(w,{rows:10,animated:""})])):p.curtainStore.error?((0,t.uX)(),(0,t.CE)("div",n,[(0,t.bF)(V,{title:p.curtainStore.error,type:"error","show-icon":""},null,8,["title"])])):((0,t.uX)(),(0,t.CE)("div",d,[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(K,{data:p.curtainStore.curtains,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(C,{prop:"id",label:"ID",width:"80"}),(0,t.bF)(C,{label:"图片",width:"120"},{default:(0,t.k6)((({row:e})=>[(0,t.bF)(R,{src:e.image_url,style:{width:"80px",height:"80px"},fit:"cover","preview-src-list":[e.image_url]},{error:(0,t.k6)((()=>[(0,t.Lk)("div",c,[(0,t.bF)(W,null,{default:(0,t.k6)((()=>[(0,t.bF)(U)])),_:1})])])),_:2},1032,["src","preview-src-list"])])),_:1}),(0,t.bF)(C,{prop:"name",label:"名称"}),(0,t.bF)(C,{prop:"category_name",label:"分类",width:"120"}),(0,t.bF)(C,{label:"库存状态",width:"100"},{default:(0,t.k6)((({row:e})=>[(0,t.bF)(X,{type:e.in_stock?"success":"danger"},{default:(0,t.k6)((()=>[(0,t.eW)((0,r.v_)(e.in_stock?"有库存":"缺货"),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(C,{label:"新品",width:"80"},{default:(0,t.k6)((({row:e})=>[e.is_new?((0,t.uX)(),(0,t.Wv)(X,{key:0,type:"warning"},{default:(0,t.k6)((()=>l[20]||(l[20]=[(0,t.eW)("新品")]))),_:1})):((0,t.uX)(),(0,t.CE)("span",s,"-"))])),_:1}),(0,t.bF)(C,{label:"操作",width:"200"},{default:(0,t.k6)((({row:e})=>[(0,t.bF)(F,{size:"small",onClick:l=>p.showEditDialog(e)},{default:(0,t.k6)((()=>l[21]||(l[21]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(E,{title:"确定要删除这个窗帘样本吗？",onConfirm:l=>p.handleDelete(e.id)},{reference:(0,t.k6)((()=>[(0,t.bF)(F,{size:"small",type:"danger"},{default:(0,t.k6)((()=>l[22]||(l[22]=[(0,t.eW)("删除")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[q,p.tableLoading]])]))])),_:1}),(0,t.bF)(I,{title:"add"===p.dialogType?"添加窗帘样本":"编辑窗帘样本",modelValue:p.dialogVisible,"onUpdate:modelValue":l[15]||(l[15]=e=>p.dialogVisible=e),width:"600px"},{footer:(0,t.k6)((()=>[(0,t.bF)(F,{onClick:l[14]||(l[14]=e=>p.dialogVisible=!1)},{default:(0,t.k6)((()=>l[24]||(l[24]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(F,{type:"primary",onClick:p.handleSubmit,loading:p.submitLoading},{default:(0,t.k6)((()=>l[25]||(l[25]=[(0,t.eW)("确定")]))),_:1},8,["onClick","loading"])])),default:(0,t.k6)((()=>[(0,t.bF)(y,{ref:"curtainFormRef",model:p.curtainForm,rules:p.curtainRules,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(f,{label:"样本名称",prop:"name"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:p.curtainForm.name,"onUpdate:modelValue":l[3]||(l[3]=e=>p.curtainForm.name=e),placeholder:"请输入窗帘样本名称"},null,8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"分类",prop:"category_id"},{default:(0,t.k6)((()=>[(0,t.bF)(h,{modelValue:p.curtainForm.category_id,"onUpdate:modelValue":l[4]||(l[4]=e=>p.curtainForm.category_id=e),placeholder:"请选择分类"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(p.curtainStore.categories,(e=>((0,t.uX)(),(0,t.Wv)(_,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"样本图片",prop:"image"},{default:(0,t.k6)((()=>[(0,t.bF)(D,{class:"image-upload",action:"#","http-request":p.handleImageUpload,"show-file-list":!1,"before-upload":p.beforeImageUpload},{default:(0,t.k6)((()=>[p.imageUrl?((0,t.uX)(),(0,t.CE)("img",{key:0,src:p.imageUrl,class:"preview-image"},null,8,m)):((0,t.uX)(),(0,t.Wv)(W,{key:1,class:"upload-icon"},{default:(0,t.k6)((()=>[(0,t.bF)(L)])),_:1})),l[23]||(l[23]=(0,t.Lk)("div",{class:"upload-text"},"点击上传图片",-1))])),_:1},8,["http-request","before-upload"])])),_:1}),(0,t.bF)(f,{label:"价格",prop:"price"},{default:(0,t.k6)((()=>[(0,t.bF)(S,{modelValue:p.curtainForm.price,"onUpdate:modelValue":l[5]||(l[5]=e=>p.curtainForm.price=e),precision:2,step:10,min:0},null,8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"材质",prop:"material"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:p.curtainForm.material,"onUpdate:modelValue":l[6]||(l[6]=e=>p.curtainForm.material=e),placeholder:"请输入窗帘材质"},null,8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"宽度",prop:"width"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:p.curtainForm.width,"onUpdate:modelValue":l[7]||(l[7]=e=>p.curtainForm.width=e),placeholder:"请输入窗帘宽度"},null,8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"图案",prop:"pattern"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:p.curtainForm.pattern,"onUpdate:modelValue":l[8]||(l[8]=e=>p.curtainForm.pattern=e),placeholder:"请输入窗帘图案"},null,8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"风格",prop:"style"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:p.curtainForm.style,"onUpdate:modelValue":l[9]||(l[9]=e=>p.curtainForm.style=e),placeholder:"请输入窗帘风格"},null,8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"功能",prop:"features"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:p.curtainForm.features,"onUpdate:modelValue":l[10]||(l[10]=e=>p.curtainForm.features=e),placeholder:"请输入窗帘功能特点"},null,8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"描述",prop:"description"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:p.curtainForm.description,"onUpdate:modelValue":l[11]||(l[11]=e=>p.curtainForm.description=e),type:"textarea",rows:4,placeholder:"请输入窗帘样本描述"},null,8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"库存状态",prop:"in_stock"},{default:(0,t.k6)((()=>[(0,t.bF)(x,{modelValue:p.curtainForm.in_stock,"onUpdate:modelValue":l[12]||(l[12]=e=>p.curtainForm.in_stock=e)},null,8,["modelValue"])])),_:1}),(0,t.bF)(f,{label:"新品",prop:"is_new"},{default:(0,t.k6)((()=>[(0,t.bF)(x,{modelValue:p.curtainForm.is_new,"onUpdate:modelValue":l[13]||(l[13]=e=>p.curtainForm.is_new=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])}a(8111),a(2489),a(7588);var b=a(144),g=a(6191),F=a(1219),k={name:"CurtainManage",setup(){const e=(0,g.x)(),l=(0,b.KR)(null),a=(0,b.KR)(!1),r=(0,b.KR)("add"),i=(0,b.KR)(!1),o=(0,b.KR)(!1),u=(0,b.KR)(""),n=(0,b.KR)(null),d=(0,b.Kh)({name:"",category_id:"",in_stock:""}),c=(0,b.Kh)({id:null,name:"",category_id:"",price:0,material:"",width:"",pattern:"",style:"",features:"",description:"",in_stock:!0,is_new:!1}),s={name:[{required:!0,message:"请输入窗帘样本名称",trigger:"blur"},{min:2,max:50,message:"长度应为2-50个字符",trigger:"blur"}],category_id:[{required:!0,message:"请选择分类",trigger:"change"}],description:[{required:!0,message:"请输入窗帘样本描述",trigger:"blur"}]};(0,t.sV)((async()=>{e.categories.length||await e.fetchCategories(),await e.fetchCurtains()}));const m=()=>{r.value="add",k(),a.value=!0},p=e=>{r.value="edit",k(),Object.keys(c).forEach((l=>{l in e&&(c[l]=e[l])})),e.image_url&&(u.value=e.image_url),a.value=!0},k=()=>{l.value&&l.value.resetFields(),Object.assign(c,{id:null,name:"",category_id:"",price:0,material:"",width:"",pattern:"",style:"",features:"",description:"",in_stock:!0,is_new:!1}),u.value="",n.value=null},f=e=>{const l=e.type.startsWith("image/"),a=e.size/1024/1024<2;return l?!!a||(F.nk.error("图片大小不能超过2MB!"),!1):(F.nk.error("只能上传图片文件!"),!1)},_=e=>{const l=e.file;n.value=l;const a=new FileReader;a.onload=e=>{u.value=e.target.result},a.readAsDataURL(l)},h=async()=>{l.value&&await l.value.validate((async l=>{if(l){i.value=!0;try{const l=new FormData;Object.keys(c).forEach((e=>{"id"!==e&&l.append(e,c[e])})),n.value&&l.append("image",n.value),"add"===r.value?(await e.addCurtain(l),F.nk.success("添加窗帘样本成功")):(await e.updateCurtain(c.id,l),F.nk.success("更新窗帘样本成功")),a.value=!1,k()}catch(t){F.nk.error(t.message||"操作失败")}finally{i.value=!1}}}))},y=async l=>{try{o.value=!0,await e.deleteCurtain(l),F.nk.success("删除窗帘样本成功")}catch(a){F.nk.error(a.message||"删除失败")}finally{o.value=!1}},v=async()=>{o.value=!0;try{await e.fetchCurtains(),d.name&&(e.curtains=e.curtains.filter((e=>e.name.toLowerCase().includes(d.name.toLowerCase())))),d.category_id&&(e.curtains=e.curtains.filter((e=>e.category_id===d.category_id))),""!==d.in_stock&&(e.curtains=e.curtains.filter((e=>e.in_stock===d.in_stock)))}catch(l){F.nk.error("筛选失败: "+l.message)}finally{o.value=!1}},w=()=>{Object.assign(d,{name:"",category_id:"",in_stock:""}),e.fetchCurtains()};return{curtainStore:e,curtainForm:c,curtainRules:s,curtainFormRef:l,dialogVisible:a,dialogType:r,submitLoading:i,tableLoading:o,imageUrl:u,filterForm:d,showAddDialog:m,showEditDialog:p,handleSubmit:h,handleDelete:y,handleFilter:v,resetFilter:w,beforeImageUpload:f,handleImageUpload:_}}},f=a(1241);const _=(0,f.A)(k,[["render",p],["__scopeId","data-v-46067832"]]);var h=_}}]);
//# sourceMappingURL=251.0b333c6c.js.map